{"ast":null,"code":"import React from'react';import{Modal,Form,Input,Button,message,Divider,Space}from'antd';import{UserOutlined,LockOutlined,MailOutlined,PhoneOutlined}from'@ant-design/icons';import{useDispatch,useSelector}from'react-redux';import{hideRegisterModal,showLoginModal,setLoading}from'../store/slices/userSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegisterModal=()=>{const[form]=Form.useForm();const dispatch=useDispatch();const{registerModalVisible,loading,error}=useSelector(state=>state.user);const handleOk=async()=>{try{const values=await form.validateFields();dispatch(setLoading(true));// 模拟注册API调用\nsetTimeout(()=>{dispatch(setLoading(false));message.success('注册成功！请登录');form.resetFields();dispatch(hideRegisterModal());dispatch(showLoginModal());},1000);}catch(errorInfo){console.log('表单验证失败:',errorInfo);}};const handleCancel=()=>{dispatch(hideRegisterModal());form.resetFields();};const handleShowLogin=()=>{dispatch(showLoginModal());};return/*#__PURE__*/_jsxs(Modal,{title:\"\\u7528\\u6237\\u6CE8\\u518C\",open:registerModalVisible,onOk:handleOk,onCancel:handleCancel,confirmLoading:loading,okText:\"\\u6CE8\\u518C\",cancelText:\"\\u53D6\\u6D88\",width:450,children:[/*#__PURE__*/_jsxs(Form,{form:form,name:\"register\",autoComplete:\"off\",layout:\"vertical\",children:[error&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16,color:'#ff4d4f',textAlign:'center'},children:error}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u7528\\u6237\\u540D\",name:\"username\",rules:[{required:true,message:'请输入用户名!'},{min:3,max:20,message:'用户名长度为3-20个字符!'},{pattern:/^[a-zA-Z0-9_]+$/,message:'用户名只能包含字母、数字和下划线!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(UserOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u90AE\\u7BB1\",name:\"email\",rules:[{required:true,message:'请输入邮箱!'},{type:'email',message:'请输入有效的邮箱地址!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(MailOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u90AE\\u7BB1\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u624B\\u673A\\u53F7\",name:\"phone\",rules:[{required:true,message:'请输入手机号!'},{pattern:/^1[3-9]\\d{9}$/,message:'请输入有效的手机号!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(PhoneOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u5BC6\\u7801\",name:\"password\",rules:[{required:true,message:'请输入密码!'},{min:6,max:20,message:'密码长度为6-20个字符!'}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u786E\\u8BA4\\u5BC6\\u7801\",name:\"confirmPassword\",dependencies:['password'],rules:[{required:true,message:'请确认密码!'},_ref=>{let{getFieldValue}=_ref;return{validator(_,value){if(!value||getFieldValue('password')===value){return Promise.resolve();}return Promise.reject(new Error('两次输入的密码不一致!'));}};}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u786E\\u8BA4\\u5BC6\\u7801\",size:\"large\"})})]}),/*#__PURE__*/_jsx(Divider,{plain:true,children:\"\\u5176\\u4ED6\\u64CD\\u4F5C\"}),/*#__PURE__*/_jsx(Space,{direction:\"vertical\",style:{width:'100%',textAlign:'center'},children:/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:handleShowLogin,children:\"\\u5DF2\\u6709\\u8D26\\u53F7\\uFF1F\\u7ACB\\u5373\\u767B\\u5F55\"})})]});};export default RegisterModal;","map":{"version":3,"names":["React","Modal","Form","Input","Button","message","Divider","Space","UserOutlined","LockOutlined","MailOutlined","PhoneOutlined","useDispatch","useSelector","hideRegisterModal","showLoginModal","setLoading","jsx","_jsx","jsxs","_jsxs","RegisterModal","form","useForm","dispatch","registerModalVisible","loading","error","state","user","handleOk","values","validateFields","setTimeout","success","resetFields","errorInfo","console","log","handleCancel","handleShowLogin","title","open","onOk","onCancel","confirmLoading","okText","cancelText","width","children","name","autoComplete","layout","style","marginBottom","color","textAlign","Item","label","rules","required","min","max","pattern","prefix","placeholder","size","type","Password","dependencies","_ref","getFieldValue","validator","_","value","Promise","resolve","reject","Error","plain","direction","onClick"],"sources":["D:/luckymall/frontend/src/components/RegisterModal.tsx"],"sourcesContent":["import React from 'react';\r\nimport { \r\n  Modal, \r\n  Form, \r\n  Input, \r\n  Button, \r\n  message, \r\n  Divider,\r\n  Space \r\n} from 'antd';\r\nimport { UserOutlined, LockOutlined, MailOutlined, PhoneOutlined } from '@ant-design/icons';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { RootState, AppDispatch } from '../store';\r\nimport { \r\n  hideRegisterModal, \r\n  showLoginModal, \r\n  setLoading, \r\n  setError \r\n} from '../store/slices/userSlice';\r\n\r\ninterface RegisterFormData {\r\n  username: string;\r\n  email: string;\r\n  phone: string;\r\n  password: string;\r\n  confirmPassword: string;\r\n}\r\n\r\nconst RegisterModal: React.FC = () => {\r\n  const [form] = Form.useForm();\r\n  const dispatch = useDispatch<AppDispatch>();\r\n  \r\n  const { registerModalVisible, loading, error } = useSelector(\r\n    (state: RootState) => state.user\r\n  );\r\n  \r\n  const handleOk = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      dispatch(setLoading(true));\r\n      \r\n      // 模拟注册API调用\r\n      setTimeout(() => {\r\n        dispatch(setLoading(false));\r\n        message.success('注册成功！请登录');\r\n        form.resetFields();\r\n        dispatch(hideRegisterModal());\r\n        dispatch(showLoginModal());\r\n      }, 1000);\r\n      \r\n    } catch (errorInfo) {\r\n      console.log('表单验证失败:', errorInfo);\r\n    }\r\n  };\r\n  \r\n  const handleCancel = () => {\r\n    dispatch(hideRegisterModal());\r\n    form.resetFields();\r\n  };\r\n  \r\n  const handleShowLogin = () => {\r\n    dispatch(showLoginModal());\r\n  };\r\n  \r\n  return (\r\n    <Modal\r\n      title=\"用户注册\"\r\n      open={registerModalVisible}\r\n      onOk={handleOk}\r\n      onCancel={handleCancel}\r\n      confirmLoading={loading}\r\n      okText=\"注册\"\r\n      cancelText=\"取消\"\r\n      width={450}\r\n    >\r\n      <Form\r\n        form={form}\r\n        name=\"register\"\r\n        autoComplete=\"off\"\r\n        layout=\"vertical\"\r\n      >\r\n        {error && (\r\n          <div style={{ marginBottom: 16, color: '#ff4d4f', textAlign: 'center' }}>\r\n            {error}\r\n          </div>\r\n        )}\r\n        \r\n        <Form.Item\r\n          label=\"用户名\"\r\n          name=\"username\"\r\n          rules={[\r\n            { required: true, message: '请输入用户名!' },\r\n            { min: 3, max: 20, message: '用户名长度为3-20个字符!' },\r\n            { pattern: /^[a-zA-Z0-9_]+$/, message: '用户名只能包含字母、数字和下划线!' }\r\n          ]}\r\n        >\r\n          <Input \r\n            prefix={<UserOutlined />} \r\n            placeholder=\"请输入用户名\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          label=\"邮箱\"\r\n          name=\"email\"\r\n          rules={[\r\n            { required: true, message: '请输入邮箱!' },\r\n            { type: 'email', message: '请输入有效的邮箱地址!' }\r\n          ]}\r\n        >\r\n          <Input \r\n            prefix={<MailOutlined />} \r\n            placeholder=\"请输入邮箱\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          label=\"手机号\"\r\n          name=\"phone\"\r\n          rules={[\r\n            { required: true, message: '请输入手机号!' },\r\n            { pattern: /^1[3-9]\\d{9}$/, message: '请输入有效的手机号!' }\r\n          ]}\r\n        >\r\n          <Input \r\n            prefix={<PhoneOutlined />} \r\n            placeholder=\"请输入手机号\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          label=\"密码\"\r\n          name=\"password\"\r\n          rules={[\r\n            { required: true, message: '请输入密码!' },\r\n            { min: 6, max: 20, message: '密码长度为6-20个字符!' }\r\n          ]}\r\n        >\r\n          <Input.Password \r\n            prefix={<LockOutlined />} \r\n            placeholder=\"请输入密码\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          label=\"确认密码\"\r\n          name=\"confirmPassword\"\r\n          dependencies={['password']}\r\n          rules={[\r\n            { required: true, message: '请确认密码!' },\r\n            ({ getFieldValue }) => ({\r\n              validator(_, value) {\r\n                if (!value || getFieldValue('password') === value) {\r\n                  return Promise.resolve();\r\n                }\r\n                return Promise.reject(new Error('两次输入的密码不一致!'));\r\n              },\r\n            }),\r\n          ]}\r\n        >\r\n          <Input.Password \r\n            prefix={<LockOutlined />} \r\n            placeholder=\"请确认密码\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n      </Form>\r\n      \r\n      <Divider plain>其他操作</Divider>\r\n      \r\n      <Space direction=\"vertical\" style={{ width: '100%', textAlign: 'center' }}>\r\n        <Button type=\"link\" onClick={handleShowLogin}>\r\n          已有账号？立即登录\r\n        </Button>\r\n      </Space>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default RegisterModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}