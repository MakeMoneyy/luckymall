{"ast":null,"code":"import React from'react';import{Modal,Form,Input,Button,Checkbox,message,Divider,Space}from'antd';import{UserOutlined,LockOutlined}from'@ant-design/icons';import{useDispatch,useSelector}from'react-redux';import{setCurrentUser,hideLoginModal,showRegisterModal,setLoading}from'../store/slices/userSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginModal=()=>{const[form]=Form.useForm();const dispatch=useDispatch();const{loginModalVisible,loading,error}=useSelector(state=>state.user);const handleOk=async()=>{try{const values=await form.validateFields();dispatch(setLoading(true));// 模拟登录API调用\nsetTimeout(()=>{// 模拟登录成功\nconst mockUser={id:1,username:values.username,email:`${values.username}@example.com`,phone:'13800138000',createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};dispatch(setCurrentUser(mockUser));dispatch(setLoading(false));message.success('登录成功！');form.resetFields();},1000);}catch(errorInfo){console.log('表单验证失败:',errorInfo);}};const handleCancel=()=>{dispatch(hideLoginModal());form.resetFields();};const handleShowRegister=()=>{dispatch(showRegisterModal());};return/*#__PURE__*/_jsxs(Modal,{title:\"\\u7528\\u6237\\u767B\\u5F55\",open:loginModalVisible,onOk:handleOk,onCancel:handleCancel,confirmLoading:loading,okText:\"\\u767B\\u5F55\",cancelText:\"\\u53D6\\u6D88\",width:400,children:[/*#__PURE__*/_jsxs(Form,{form:form,name:\"login\",initialValues:{remember:true},autoComplete:\"off\",layout:\"vertical\",children:[error&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16,color:'#ff4d4f',textAlign:'center'},children:error}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u7528\\u6237\\u540D\",name:\"username\",rules:[{required:true,message:'请输入用户名!'},{min:3,message:'用户名至少3个字符!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(UserOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u5BC6\\u7801\",name:\"password\",rules:[{required:true,message:'请输入密码!'},{min:6,message:'密码至少6个字符!'}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",size:\"large\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"remember\",valuePropName:\"checked\",children:/*#__PURE__*/_jsx(Checkbox,{children:\"\\u8BB0\\u4F4F\\u6211\"})})]}),/*#__PURE__*/_jsx(Divider,{plain:true,children:\"\\u5176\\u4ED6\\u64CD\\u4F5C\"}),/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",style:{width:'100%',textAlign:'center'},children:[/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:handleShowRegister,children:\"\\u8FD8\\u6CA1\\u6709\\u8D26\\u53F7\\uFF1F\\u7ACB\\u5373\\u6CE8\\u518C\"}),/*#__PURE__*/_jsx(Button,{type:\"link\",size:\"small\",children:\"\\u5FD8\\u8BB0\\u5BC6\\u7801\\uFF1F\"})]})]});};export default LoginModal;","map":{"version":3,"names":["React","Modal","Form","Input","Button","Checkbox","message","Divider","Space","UserOutlined","LockOutlined","useDispatch","useSelector","setCurrentUser","hideLoginModal","showRegisterModal","setLoading","jsx","_jsx","jsxs","_jsxs","LoginModal","form","useForm","dispatch","loginModalVisible","loading","error","state","user","handleOk","values","validateFields","setTimeout","mockUser","id","username","email","phone","createdAt","Date","toISOString","updatedAt","success","resetFields","errorInfo","console","log","handleCancel","handleShowRegister","title","open","onOk","onCancel","confirmLoading","okText","cancelText","width","children","name","initialValues","remember","autoComplete","layout","style","marginBottom","color","textAlign","Item","label","rules","required","min","prefix","placeholder","size","Password","valuePropName","plain","direction","type","onClick"],"sources":["D:/luckymall/frontend/src/components/LoginModal.tsx"],"sourcesContent":["import React from 'react';\r\nimport { \r\n  Modal, \r\n  Form, \r\n  Input, \r\n  Button, \r\n  Checkbox, \r\n  message, \r\n  Divider,\r\n  Space \r\n} from 'antd';\r\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { RootState, AppDispatch } from '../store';\r\nimport { \r\n  setCurrentUser, \r\n  hideLoginModal, \r\n  showRegisterModal, \r\n  setLoading, \r\n  setError \r\n} from '../store/slices/userSlice';\r\n\r\ninterface LoginFormData {\r\n  username: string;\r\n  password: string;\r\n  remember: boolean;\r\n}\r\n\r\nconst LoginModal: React.FC = () => {\r\n  const [form] = Form.useForm();\r\n  const dispatch = useDispatch<AppDispatch>();\r\n  \r\n  const { loginModalVisible, loading, error } = useSelector(\r\n    (state: RootState) => state.user\r\n  );\r\n  \r\n  const handleOk = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      dispatch(setLoading(true));\r\n      \r\n      // 模拟登录API调用\r\n      setTimeout(() => {\r\n        // 模拟登录成功\r\n        const mockUser = {\r\n          id: 1,\r\n          username: values.username,\r\n          email: `${values.username}@example.com`,\r\n          phone: '13800138000',\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        };\r\n        \r\n        dispatch(setCurrentUser(mockUser));\r\n        dispatch(setLoading(false));\r\n        message.success('登录成功！');\r\n        form.resetFields();\r\n      }, 1000);\r\n      \r\n    } catch (errorInfo) {\r\n      console.log('表单验证失败:', errorInfo);\r\n    }\r\n  };\r\n  \r\n  const handleCancel = () => {\r\n    dispatch(hideLoginModal());\r\n    form.resetFields();\r\n  };\r\n  \r\n  const handleShowRegister = () => {\r\n    dispatch(showRegisterModal());\r\n  };\r\n  \r\n  return (\r\n    <Modal\r\n      title=\"用户登录\"\r\n      open={loginModalVisible}\r\n      onOk={handleOk}\r\n      onCancel={handleCancel}\r\n      confirmLoading={loading}\r\n      okText=\"登录\"\r\n      cancelText=\"取消\"\r\n      width={400}\r\n    >\r\n      <Form\r\n        form={form}\r\n        name=\"login\"\r\n        initialValues={{ remember: true }}\r\n        autoComplete=\"off\"\r\n        layout=\"vertical\"\r\n      >\r\n        {error && (\r\n          <div style={{ marginBottom: 16, color: '#ff4d4f', textAlign: 'center' }}>\r\n            {error}\r\n          </div>\r\n        )}\r\n        \r\n        <Form.Item\r\n          label=\"用户名\"\r\n          name=\"username\"\r\n          rules={[\r\n            { required: true, message: '请输入用户名!' },\r\n            { min: 3, message: '用户名至少3个字符!' }\r\n          ]}\r\n        >\r\n          <Input \r\n            prefix={<UserOutlined />} \r\n            placeholder=\"请输入用户名\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          label=\"密码\"\r\n          name=\"password\"\r\n          rules={[\r\n            { required: true, message: '请输入密码!' },\r\n            { min: 6, message: '密码至少6个字符!' }\r\n          ]}\r\n        >\r\n          <Input.Password \r\n            prefix={<LockOutlined />} \r\n            placeholder=\"请输入密码\" \r\n            size=\"large\"\r\n          />\r\n        </Form.Item>\r\n        \r\n        <Form.Item name=\"remember\" valuePropName=\"checked\">\r\n          <Checkbox>记住我</Checkbox>\r\n        </Form.Item>\r\n      </Form>\r\n      \r\n      <Divider plain>其他操作</Divider>\r\n      \r\n      <Space direction=\"vertical\" style={{ width: '100%', textAlign: 'center' }}>\r\n        <Button type=\"link\" onClick={handleShowRegister}>\r\n          还没有账号？立即注册\r\n        </Button>\r\n        <Button type=\"link\" size=\"small\">\r\n          忘记密码？\r\n        </Button>\r\n      </Space>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default LoginModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}