{"ast":null,"code":"import React from'react';import{Layout as AntLayout,Menu,Button,Space,Badge,Avatar,Dropdown,Typography}from'antd';import{ShoppingCartOutlined,UserOutlined,LoginOutlined,LogoutOutlined,FileTextOutlined}from'@ant-design/icons';import{useDispatch,useSelector}from'react-redux';import{useNavigate,useLocation}from'react-router-dom';import{showLoginModal,clearCurrentUser}from'../store/slices/userSlice';import SearchBar from'./SearchBar';import LoginModal from'./LoginModal';import RegisterModal from'./RegisterModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Header,Content}=AntLayout;const{Title}=Typography;const Layout=_ref=>{let{children}=_ref;const navigate=useNavigate();const location=useLocation();const dispatch=useDispatch();const{currentUser,isLoggedIn}=useSelector(state=>state.user);const{totalQuantity}=useSelector(state=>state.cart);// 处理用户菜单点击\nconst handleUserMenuClick=_ref2=>{let{key}=_ref2;switch(key){case'orders':navigate('/orders');break;case'logout':dispatch(clearCurrentUser());navigate('/');break;default:break;}};// 用户下拉菜单\nconst userMenu=/*#__PURE__*/_jsxs(Menu,{onClick:handleUserMenuClick,children:[/*#__PURE__*/_jsx(Menu.Item,{icon:/*#__PURE__*/_jsx(FileTextOutlined,{}),children:\"\\u6211\\u7684\\u8BA2\\u5355\"},\"orders\"),/*#__PURE__*/_jsx(Menu.Divider,{}),/*#__PURE__*/_jsx(Menu.Item,{icon:/*#__PURE__*/_jsx(LogoutOutlined,{}),children:\"\\u9000\\u51FA\\u767B\\u5F55\"},\"logout\")]});// 获取当前页面菜单选中状态\nconst getSelectedMenuKey=()=>{const path=location.pathname;if(path==='/')return'home';if(path.startsWith('/search'))return'search';if(path.startsWith('/cart'))return'cart';if(path.startsWith('/orders'))return'orders';return'home';};return/*#__PURE__*/_jsxs(AntLayout,{style:{minHeight:'100vh'},children:[/*#__PURE__*/_jsxs(Header,{style:{display:'flex',alignItems:'center',justifyContent:'space-between',backgroundColor:'#fff',borderBottom:'1px solid #f0f0f0',padding:'0 24px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginRight:32,cursor:'pointer',display:'flex',alignItems:'center'},onClick:()=>navigate('/'),children:/*#__PURE__*/_jsx(Title,{level:3,style:{margin:0,color:'#1890ff'},children:\"\\u62DB\\u8D22\\u5546\\u57CE\"})}),/*#__PURE__*/_jsx(Menu,{mode:\"horizontal\",selectedKeys:[getSelectedMenuKey()],style:{border:'none',backgroundColor:'transparent',marginRight:32},children:/*#__PURE__*/_jsx(Menu.Item,{onClick:()=>navigate('/'),children:\"\\u9996\\u9875\"},\"home\")}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,maxWidth:400},children:/*#__PURE__*/_jsx(SearchBar,{placeholder:\"\\u641C\\u7D22\\u5546\\u54C1...\",size:\"middle\"})})]}),/*#__PURE__*/_jsxs(Space,{size:\"large\",children:[/*#__PURE__*/_jsx(Badge,{count:totalQuantity,size:\"small\",children:/*#__PURE__*/_jsx(Button,{type:\"text\",icon:/*#__PURE__*/_jsx(ShoppingCartOutlined,{}),size:\"large\",onClick:()=>navigate('/cart'),children:\"\\u8D2D\\u7269\\u8F66\"})}),isLoggedIn&&currentUser?/*#__PURE__*/_jsx(Dropdown,{overlay:userMenu,placement:\"bottomRight\",children:/*#__PURE__*/_jsxs(Space,{style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(Avatar,{icon:/*#__PURE__*/_jsx(UserOutlined,{})}),/*#__PURE__*/_jsx(\"span\",{children:currentUser.username})]})}):/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(LoginOutlined,{}),onClick:()=>dispatch(showLoginModal()),children:\"\\u767B\\u5F55\"})]})]}),/*#__PURE__*/_jsx(Content,{style:{backgroundColor:'#f5f5f5'},children:children}),/*#__PURE__*/_jsx(LoginModal,{}),/*#__PURE__*/_jsx(RegisterModal,{})]});};export default Layout;","map":{"version":3,"names":["React","Layout","AntLayout","Menu","Button","Space","Badge","Avatar","Dropdown","Typography","ShoppingCartOutlined","UserOutlined","LoginOutlined","LogoutOutlined","FileTextOutlined","useDispatch","useSelector","useNavigate","useLocation","showLoginModal","clearCurrentUser","SearchBar","LoginModal","RegisterModal","jsx","_jsx","jsxs","_jsxs","Header","Content","Title","_ref","children","navigate","location","dispatch","currentUser","isLoggedIn","state","user","totalQuantity","cart","handleUserMenuClick","_ref2","key","userMenu","onClick","Item","icon","Divider","getSelectedMenuKey","path","pathname","startsWith","style","minHeight","display","alignItems","justifyContent","backgroundColor","borderBottom","padding","flex","marginRight","cursor","level","margin","color","mode","selectedKeys","border","maxWidth","placeholder","size","count","type","overlay","placement","username"],"sources":["D:/luckymall/frontend/src/components/Layout.tsx"],"sourcesContent":["import React from 'react';\r\nimport { \r\n  Layout as AntLayout, \r\n  Menu, \r\n  Button, \r\n  Space, \r\n  Badge, \r\n  Avatar, \r\n  Dropdown,\r\n  Typography\r\n} from 'antd';\r\nimport { \r\n  ShoppingCartOutlined, \r\n  UserOutlined, \r\n  LoginOutlined,\r\n  LogoutOutlined,\r\n  FileTextOutlined,\r\n  SearchOutlined\r\n} from '@ant-design/icons';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { RootState, AppDispatch } from '../store';\r\nimport { \r\n  showLoginModal, \r\n  clearCurrentUser \r\n} from '../store/slices/userSlice';\r\nimport { openCart } from '../store/slices/cartSlice';\r\nimport SearchBar from './SearchBar';\r\nimport LoginModal from './LoginModal';\r\nimport RegisterModal from './RegisterModal';\r\n\r\nconst { Header, Content } = AntLayout;\r\nconst { Title } = Typography;\r\n\r\ninterface LayoutProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst Layout: React.FC<LayoutProps> = ({ children }) => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const dispatch = useDispatch<AppDispatch>();\r\n  \r\n  const { currentUser, isLoggedIn } = useSelector((state: RootState) => state.user);\r\n  const { totalQuantity } = useSelector((state: RootState) => state.cart);\r\n  \r\n  // 处理用户菜单点击\r\n  const handleUserMenuClick = ({ key }: { key: string }) => {\r\n    switch (key) {\r\n      case 'orders':\r\n        navigate('/orders');\r\n        break;\r\n      case 'logout':\r\n        dispatch(clearCurrentUser());\r\n        navigate('/');\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  \r\n  // 用户下拉菜单\r\n  const userMenu = (\r\n    <Menu onClick={handleUserMenuClick}>\r\n      <Menu.Item key=\"orders\" icon={<FileTextOutlined />}>\r\n        我的订单\r\n      </Menu.Item>\r\n      <Menu.Divider />\r\n      <Menu.Item key=\"logout\" icon={<LogoutOutlined />}>\r\n        退出登录\r\n      </Menu.Item>\r\n    </Menu>\r\n  );\r\n  \r\n  // 获取当前页面菜单选中状态\r\n  const getSelectedMenuKey = () => {\r\n    const path = location.pathname;\r\n    if (path === '/') return 'home';\r\n    if (path.startsWith('/search')) return 'search';\r\n    if (path.startsWith('/cart')) return 'cart';\r\n    if (path.startsWith('/orders')) return 'orders';\r\n    return 'home';\r\n  };\r\n  \r\n  return (\r\n    <AntLayout style={{ minHeight: '100vh' }}>\r\n      <Header style={{ \r\n        display: 'flex', \r\n        alignItems: 'center', \r\n        justifyContent: 'space-between',\r\n        backgroundColor: '#fff',\r\n        borderBottom: '1px solid #f0f0f0',\r\n        padding: '0 24px'\r\n      }}>\r\n        {/* 左侧Logo和主导航 */}\r\n        <div style={{ display: 'flex', alignItems: 'center', flex: 1 }}>\r\n          <div \r\n            style={{ \r\n              marginRight: 32, \r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              alignItems: 'center'\r\n            }}\r\n            onClick={() => navigate('/')}\r\n          >\r\n            <Title level={3} style={{ margin: 0, color: '#1890ff' }}>\r\n              招财商城\r\n            </Title>\r\n          </div>\r\n          \r\n          <Menu \r\n            mode=\"horizontal\" \r\n            selectedKeys={[getSelectedMenuKey()]}\r\n            style={{ \r\n              border: 'none',\r\n              backgroundColor: 'transparent',\r\n              marginRight: 32\r\n            }}\r\n          >\r\n            <Menu.Item key=\"home\" onClick={() => navigate('/')}>\r\n              首页\r\n            </Menu.Item>\r\n          </Menu>\r\n          \r\n          {/* 搜索框 */}\r\n          <div style={{ flex: 1, maxWidth: 400 }}>\r\n            <SearchBar \r\n              placeholder=\"搜索商品...\" \r\n              size=\"middle\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 右侧用户操作 */}\r\n        <Space size=\"large\">\r\n          {/* 购物车 */}\r\n          <Badge count={totalQuantity} size=\"small\">\r\n            <Button \r\n              type=\"text\" \r\n              icon={<ShoppingCartOutlined />} \r\n              size=\"large\"\r\n              onClick={() => navigate('/cart')}\r\n            >\r\n              购物车\r\n            </Button>\r\n          </Badge>\r\n          \r\n          {/* 用户信息 */}\r\n          {isLoggedIn && currentUser ? (\r\n            <Dropdown overlay={userMenu} placement=\"bottomRight\">\r\n              <Space style={{ cursor: 'pointer' }}>\r\n                <Avatar icon={<UserOutlined />} />\r\n                <span>{currentUser.username}</span>\r\n              </Space>\r\n            </Dropdown>\r\n          ) : (\r\n            <Button \r\n              type=\"primary\" \r\n              icon={<LoginOutlined />}\r\n              onClick={() => dispatch(showLoginModal())}\r\n            >\r\n              登录\r\n            </Button>\r\n          )}\r\n        </Space>\r\n      </Header>\r\n      \r\n      <Content style={{ backgroundColor: '#f5f5f5' }}>\r\n        {children}\r\n      </Content>\r\n      \r\n      {/* 模态框 */}\r\n      <LoginModal />\r\n      <RegisterModal />\r\n    </AntLayout>\r\n  );\r\n};\r\n\r\nexport default Layout; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}